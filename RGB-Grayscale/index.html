<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- ressources -->
    <link rel="stylesheet" href="index.css">
    <!-- font -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=ADLaM+Display&display=swap" rel="stylesheet">
    <!--titre-->
    <title>RGB vers Grayscale</title>
</head>
<body>
    
    <div class="container">
        <h1>Grayscale to Color Converter</h1>
        <div class="bigstuff">
            <div id="input" class>
                
                <div class="stuff">
                    <div class="txt" id="txt-col">Color</div>
                    <input type="color" id="color_colorPicker" value="#ffffff">
                    <div class="values" id="color_colorValues">
                        <p id="color_hexValue">Hex: #000000</p>
                        <p id="color_rgbValue">RGB: 0, 0, 0</p>
                    </div>
                </div>
            </div>
            <img src="eq.png" id="eq"></img>
            <div id="output">
                <div class="stuff">
                    <div class="txt">Grayscale</div>
                    <div id="gray_scaleBox"></div>
                    <div class="values" id="gray_colorValues">
                        <p id="gray_hexValue">Hex: #000000</p>
                        <p id="gray_rgbValue">RGB: 0, 0, 0</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="container">
        <h1 class="txt-how">How it's calculated ?</h1>
        <ul class="txt-how">
            Well first our eyes are most sensitive to green, then red and finally blue. <br><br>
            So, by some wizardry we obtain ratios. Then we take the R,G and B of our color and make this calculation : <br><br>
            0.3 x R + 0.59 x G + 0.11 x B <br><br>
            This allow us to get a number, that will be the same for R,G and B of our grayscaled color !
        </ul>
        <h1 class="txt-how">Example</h1>
        <ul>
            <li class="txt-how" id="ex">0.3 x 255 + 0.59 x 255 + 0.11 x 255 ≃ 255</li>
            <li class="txt-how" id="fin">RGB: 255 , 255 , 255</li>
        </ul>
        
        
    </div>
    <script>
        //rgb to grayscale
        const color_colorPicker = document.getElementById('color_colorPicker');
        const gray_scaleBox = document.getElementById('gray_scaleBox');
        const gray_hexValue = document.getElementById('gray_hexValue');
        const gray_rgbValue = document.getElementById('gray_rgbValue');
        const color_hexValue = document.getElementById('color_hexValue');
        const color_rgbValue = document.getElementById('color_rgbValue');

        function convertToGrayscale(hexColor) {
            const r = parseInt(hexColor.slice(1, 3), 16);
            const g = parseInt(hexColor.slice(3, 5), 16);
            const b = parseInt(hexColor.slice(5, 7), 16);

            const grayscaleValue = 0.3 * r + 0.59 * g + 0.11 * b;
            return {
                hex: `#${Math.floor(grayscaleValue).toString(16).padStart(2, '0').repeat(3)}`,
                rgb: `${Math.floor(grayscaleValue)}, ${Math.floor(grayscaleValue)}, ${Math.floor(grayscaleValue)}`
            };
        }
        function hexToRgb(hex) {
            hex = hex.replace(/^#/, ''); // Remove # symbol
            var bigint = parseInt(hex, 16);
            var red= (bigint >> 16) & 255;
            var green = (bigint >> 8) & 255;
            var blue = bigint & 255;
            return {r:red , g:green, b:blue};
        }
        color_colorPicker.addEventListener('input', () => {
            const graytocolor_selectedColor = color_colorPicker.value;
            const graytocolor_scaleColor = convertToGrayscale(color_colorPicker.value);

            color_hexValue.textContent = `Hex: ${color_colorPicker.value}`;
            const RGB=hexToRgb(color_colorPicker.value);
            color_rgbValue.textContent = `RGB: ${RGB.r}, ${RGB.g}, ${RGB.b}`;

            gray_scaleBox.style.backgroundColor = graytocolor_scaleColor.hex;
            gray_hexValue.textContent = `Hex: ${graytocolor_scaleColor.hex}`;
            gray_rgbValue.textContent = `RGB: ${graytocolor_scaleColor.rgb}`;

            document.getElementById("ex").textContent = `0.3 x ${RGB.r} + 0.59 x ${RGB.g} + 0.11 x ${RGB.b} ≃ ${Math.floor(0.3 * RGB.r + 0.59 * RGB.g + 0.11 * RGB.b)}`
            document.getElementById("fin").textContent = `RGB: ${Math.floor(0.3 * RGB.r + 0.59 * RGB.g + 0.11 * RGB.b)} , ${Math.floor(0.3 * RGB.r + 0.59 * RGB.g + 0.11 * RGB.b)} , ${Math.floor(0.3 * RGB.r + 0.59 * RGB.g + 0.11 * RGB.b)}`

            document.getElementById("eq").style += `background: ${color_colorPicker.value};
            background: -moz-linear-gradient(90deg, ${color_colorPicker.value} 50%, ${graytocolor_scaleColor.hex} 50%);
            background: -webkit-linear-gradient(90deg, ${color_colorPicker.value} 50%, ${graytocolor_scaleColor.hex} 50%);
            background: linear-gradient(90deg, ${color_colorPicker.value} 50%, ${graytocolor_scaleColor.hex} 50%);`
        });
    </script>
</body>
</html>